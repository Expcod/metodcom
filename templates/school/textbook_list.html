{% load static %}
<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Darsliklar</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <!-- Custom CSS -->
  <link rel="stylesheet" href="{% static 'css/textbook_list.css' %}">
</head>
<body>
  <!-- Header -->
  <header class="navbar navbar-expand-lg navbar-light bg-white border-bottom">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="{% url 'maktab:home' %}">
        <i class="bi bi-mortarboard-fill text-primary me-2" style="font-size: 1.5rem;"></i>
        <span class="fw-bold">Metod<span class="text-primary">com</span></span>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="{% url 'maktab:home' %}">Bosh sahifa</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{% url 'maktab:grade_list' %}">Metodikalar</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="{% url 'maktab:textbook_list' %}">Darsliklar</a>
          </li>
        </ul>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main>
    <div class="textbook-list-container">
      <div class="container py-4">
        <!-- Breadcrumb -->
        <nav aria-label="breadcrumb" class="mb-3">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'maktab:home' %}">Bosh sahifa</a></li>
            <li class="breadcrumb-item active" aria-current="page">Darsliklar</li>
          </ol>
        </nav>

        <!-- Header -->
        <div class="textbook-header">
          <div class="row align-items-center">
            <div class="col-md-8">
              <h1 class="textbook-title">
                <i class="bi bi-book-fill text-primary me-2"></i>
                Darsliklar
              </h1>
              <p class="textbook-description">O'qituvchilar uchun elektron darsliklar to'plami</p>
            </div>
            <div class="col-md-4">
              <div class="search-container">
                <input type="text" id="textbookSearch" class="form-control" placeholder="Darslikni qidirish...">
                <i class="bi bi-search search-icon"></i>
              </div>
            </div>
          </div>
        </div>

        <!-- Textbooks Grid -->
        {% if textbooks %}
          <div class="textbooks-grid">
            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
              {% for textbook in textbooks %}
                <div class="col textbook-item" data-textbook-title="{{ textbook.title|lower }}">
                  <div class="card h-100 textbook-card">
                    <div class="card-img-container">
                      {% if textbook.cover_image %}
                        <img src="{{ textbook.cover_image.url }}" class="card-img-top" alt="{{ textbook.title }}">
                      {% else %}
                        <img src="{% static 'images/placeholder.jpg' %}" class="card-img-top" alt="Placeholder">
                      {% endif %}
                      <div class="card-img-overlay">
                        <span class="badge bg-primary">{{ textbook.grade.name }}</span>
                      </div>
                    </div>
                    <div class="card-body">
                      <h5 class="card-title">{{ textbook.title }}</h5>
                      <p class="card-text">{{ textbook.description|truncatewords:20 }}</p>
                      <div class="textbook-meta">
                        <span class="textbook-author">
                          <i class="bi bi-person"></i> {{ textbook.author|default:"Muallif ko'rsatilmagan" }}
                        </span>
                        <span class="textbook-year">
                          <i class="bi bi-calendar"></i> {{ textbook.year|default:"Yil ko'rsatilmagan" }}
                        </span>
                      </div>
                    </div>
                    <div class="card-footer">
                      <a href="{% url 'maktab:textbook_detail' textbook.id 0 %}" class="btn btn-primary w-100">
                        <i class="bi bi-book"></i> Darslikni Ko'rish
                      </a>
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>
          </div>
        {% else %}
          <div class="textbooks-empty">
            <div class="textbooks-empty-icon">
              <i class="bi bi-book-x"></i>
            </div>
            <h3 class="textbooks-empty-title">Darsliklar topilmadi</h3>
            <p class="textbooks-empty-text">Hozircha darsliklar mavjud emas.</p>
          </div>
        {% endif %}
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-light py-4 mt-auto border-top">
    <div class="container">
      <div class="row">
        <div class="col-md-6">
          <p class="mb-0">&copy; {% now "Y" %} MetodCom. Barcha huquqlar himoyalangan.</p>
        </div>
        <div class="col-md-6 text-md-end">
          <a href="#" class="text-decoration-none text-muted me-3">Foydalanish shartlari</a>
          <a href="#" class="text-decoration-none text-muted">Bog'lanish</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- Bootstrap JS Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- Custom JavaScript -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const searchInput = document.getElementById('textbookSearch');
      const textbookItems = document.querySelectorAll('.textbook-item');
      
      searchInput.addEventListener('input', function() {
        const searchTerm = this.value.toLowerCase().trim();
        
        textbookItems.forEach(item => {
          const textbookTitle = item.getAttribute('data-textbook-title');
          if (textbookTitle.includes(searchTerm)) {
            item.style.display = 'block';
          } else {
            item.style.display = 'none';
          }
        });
      });
    });
  </script>
</body>
</html>
