{% load static %}
<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ grade.name }} - Fanlar</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <!-- Custom CSS -->
  <link rel="stylesheet" href="{% static 'css/subject_list.css' %}">
</head>
<body>
  <!-- Header -->
  <header class="navbar navbar-expand-lg navbar-light bg-white border-bottom">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="{% url 'maktab:home' %}">
        <i class="bi bi-mortarboard-fill text-primary me-2" style="font-size: 1.5rem;"></i>
        <span class="fw-bold">Metod<span class="text-primary">com</span></span>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="{% url 'maktab:home' %}">Bosh sahifa</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="{% url 'maktab:grade_list' %}">Metodikalar</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{% url 'maktab:textbook_list' %}">Darsliklar</a>
          </li>
        </ul>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main>
    <div class="subject-list-container">
      <div class="container py-4">
        <!-- Breadcrumb -->
        <nav aria-label="breadcrumb" class="mb-3">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'maktab:home' %}">Bosh sahifa</a></li>
            <li class="breadcrumb-item"><a href="{% url 'maktab:grade_list' %}">Sinf Bo'yicha Metodikalar</a></li>
            <li class="breadcrumb-item active" aria-current="page">{{ grade.name }}</li>
          </ol>
        </nav>

        <!-- Header -->
        <div class="subject-header">
          <div class="row align-items-center">
            <div class="col-md-8">
              <h1 class="subject-title">
                <i class="bi bi-mortarboard-fill text-primary me-2"></i>
                {{ grade.name }} - Fanlar
              </h1>
              <p class="subject-description">{{ grade.name }} uchun metodik qo'llanmalar va resurslar to'plami</p>
            </div>
            <div class="col-md-4">
              <div class="search-container">
                <input type="text" id="subjectSearch" class="form-control" placeholder="Fanni qidirish...">
                <i class="bi bi-search search-icon"></i>
              </div>
            </div>
          </div>
        </div>

        <!-- Subjects Grid -->
        {% if subjects %}
          <div class="subjects-grid">
            <div class="row g-4">
              {% for subject in subjects %}
                <div class="col-md-6 col-lg-4 subject-item" data-subject-name="{{ subject.name|lower }}">
                  <div class="card h-100 subject-card">
                    <div class="card-accent bg-primary"></div>
                    <div class="card-body">
                      <h5 class="card-title fw-bold mb-3">{{ subject.name }}</h5>
                      <div class="mb-3">
                        <span class="badge bg-primary-subtle text-primary border border-primary-subtle px-3 py-2 rounded-pill">
                          {{ subject.sections.count }} bo'lim
                        </span>
                      </div>
                      <p class="card-text text-muted">
                        {{ subject.name }} fani uchun metodik qo'llanmalar va resurslar to'plami. O'qituvchilar uchun foydali materiallar.
                      </p>
                    </div>
                    <div class="card-footer bg-transparent border-0 pb-3">
                      {% for section in subject.sections.all %}
                        <a href="{% url 'maktab:lesson_list' section.id %}" class="btn btn-primary w-100 d-flex align-items-center justify-content-center mb-2">
                          <span>{{ section.name }}</span>
                          <i class="bi bi-book ms-2 btn-icon"></i>
                        </a>
                      {% empty %}
                        <div class="alert alert-warning text-center">
                          <i class="bi bi-exclamation-triangle me-2"></i>
                          Bo'limlar mavjud emas
                        </div>
                      {% endfor %}
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>
          </div>
        {% else %}
          <div class="subjects-empty">
            <div class="subjects-empty-icon">
              <i class="bi bi-journal-x"></i>
            </div>
            <h3 class="subjects-empty-title">Fanlar topilmadi</h3>
            <p class="subjects-empty-text">Ushbu sinf uchun hozircha fanlar mavjud emas.</p>
          </div>
        {% endif %}

        <!-- Navigation Buttons -->
        <div class="navigation-buttons mt-4">
          <a href="{% url 'maktab:grade_list' %}" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> Orqaga
          </a>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-light py-4 mt-auto border-top">
    <div class="container">
      <div class="row">
        <div class="col-md-6">
          <p class="mb-0">&copy; {% now "Y" %} MetodCom. Barcha huquqlar himoyalangan.</p>
        </div>
        <div class="col-md-6 text-md-end">
          <a href="#" class="text-decoration-none text-muted me-3">Foydalanish shartlari</a>
          <a href="#" class="text-decoration-none text-muted">Bog'lanish</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- Bootstrap JS Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- Custom JavaScript -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const searchInput = document.getElementById('subjectSearch');
      const subjectItems = document.querySelectorAll('.subject-item');
      
      searchInput.addEventListener('input', function() {
        const searchTerm = this.value.toLowerCase().trim();
        
        subjectItems.forEach(item => {
          const subjectName = item.getAttribute('data-subject-name');
          if (subjectName.includes(searchTerm)) {
            item.style.display = 'block';
          } else {
            item.style.display = 'none';
          }
        });
      });
    });
  </script>
</body>
</html>
